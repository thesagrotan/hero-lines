{"version":3,"file":"index.esm.js","sources":["../src/core/emitter.ts","../src/core/events.ts","../src/core/engine.ts"],"sourcesContent":["/**\n * 事件派发器\n */\nexport class Emitter {\n    constructor(events) {\n        this.events = {};\n        this.events = events.handlers;\n    }\n    on(names, handler) {\n        const events = names instanceof Array ? names : names.split(' ');\n        events.forEach((name) => {\n            if (!this.events[name]) {\n                throw new Error(`The event ${name} does not exist`);\n            }\n            this.events[name].push(handler);\n        });\n        return this;\n    }\n    trigger(name, params) {\n        if (!(name in this.events)) {\n            throw new Error(`The event ${String(name)} cannot be triggered`);\n        }\n        return this.events[name].reduce((r, e) => e(params) !== false && r, true); // return false if at least one event is false\n    }\n    bind(name) {\n        if (this.events[name]) {\n            throw new Error(`The event ${name} is already bound`);\n        }\n        this.events[name] = [];\n    }\n    exist(name) {\n        return Array.isArray(this.events[name]);\n    }\n    off(name, handler) {\n        if (this.events[name]) {\n            const listener = this.events[name];\n            if (!handler)\n                this.events[name] = [];\n            else {\n                const index = listener.indexOf(handler);\n                if (index !== -1)\n                    listener.splice(index, 1);\n            }\n        }\n    }\n    offAll() {\n        this.events = Object.fromEntries(Object.keys(this.events).map((name) => [name, []]));\n    }\n}\n","export class Events {\n    constructor(handlers = {}) {\n        this.handlers = {};\n        this.handlers = {\n            beforeSetTime: [],\n            afterSetTime: [],\n            setTimeByTick: [],\n            beforeSetPlayRate: [],\n            afterSetPlayRate: [],\n            setActiveActionIds: [],\n            play: [],\n            paused: [],\n            ended: [],\n            ...handlers,\n        };\n    }\n}\n","import { Emitter } from './emitter';\nimport { Events } from './events';\nconst PLAYING = 'playing';\nconst PAUSED = 'paused';\n/**\n * 时间轴播放器\n * 可脱离编辑器单独运行\n * @export\n * @class TimelineEngine\n * @extends {Emitter<EventTypes>}\n */\nexport class TimelineEngine extends Emitter {\n    constructor() {\n        super(new Events());\n        /** 播放速率 */\n        this._playRate = 1;\n        /** 当前时间 */\n        this._currentTime = 0;\n        /** 播放状态 */\n        this._playState = 'paused';\n        /** 时间帧pre数据 */\n        this._prev = 0;\n        /** 动作效果map */\n        this._effectMap = {};\n        /** 需要运行的动作map */\n        this._actionMap = {};\n        /** 按动作开始时间正序排列后的动作id数组 */\n        this._actionSortIds = [];\n        /** 当前遍历到的action index */\n        this._next = 0;\n        /** 动作时间范围包含当前时间的actionId列表 */\n        this._activeActionIds = [];\n    }\n    /** 是否正在播放 */\n    get isPlaying() {\n        return this._playState === 'playing';\n    }\n    /** 是否暂停中 */\n    get isPaused() {\n        return this._playState === 'paused';\n    }\n    set effects(effects) {\n        this._effectMap = effects;\n    }\n    set data(data) {\n        if (this.isPlaying)\n            this.pause();\n        this._dealData(data);\n        this._dealClear();\n        this._dealEnter(this._currentTime);\n    }\n    /**\n     * 设置播放速率\n     * @memberof TimelineEngine\n     */\n    setPlayRate(rate) {\n        if (rate <= 0) {\n            console.error('Error: rate cannot be less than 0!');\n            return false;\n        }\n        const result = this.trigger('beforeSetPlayRate', { rate, engine: this });\n        if (!result)\n            return false;\n        this._playRate = rate;\n        this.trigger('afterSetPlayRate', { rate, engine: this });\n        return true;\n    }\n    /**\n     * 获取播放速率\n     * @memberof TimelineEngine\n     */\n    getPlayRate() {\n        return this._playRate;\n    }\n    /**\n     * 重新渲染当前时间\n     * @return {*}\n     * @memberof TimelineEngine\n     */\n    reRender() {\n        if (this.isPlaying)\n            return;\n        this._tickAction(this._currentTime);\n    }\n    /**\n     * 设置播放时间\n     * @param {number} time\n     * @param {boolean} [isTick] 是否是tick触发\n     * @memberof TimelineEngine\n     */\n    setTime(time, isTick) {\n        const result = isTick || this.trigger('beforeSetTime', { time, engine: this });\n        if (!result)\n            return false;\n        this._currentTime = time;\n        this._next = 0;\n        this._dealLeave(time);\n        this._dealEnter(time);\n        if (isTick)\n            this.trigger('setTimeByTick', { time, engine: this });\n        else\n            this.trigger('afterSetTime', { time, engine: this });\n        return true;\n    }\n    /**\n     * 获取当前时间\n     * @return {*}  {number}\n     * @memberof TimelineEngine\n     */\n    getTime() {\n        return this._currentTime;\n    }\n    /**\n     * 运行: 开始时间为当前time\n     * @param param\n     * @return {boolean} {boolean}\n     */\n    play(param) {\n        const { toTime, autoEnd } = param;\n        const currentTime = this.getTime();\n        /** 当前状体啊正在播放中 or 运行终止时间小于开始时间 直接返回*/\n        if (this.isPlaying || (toTime && toTime <= currentTime))\n            return false;\n        // 设置运行状态\n        this._playState = PLAYING;\n        // activeIds 运行 start\n        this._startOrStop('start');\n        // 触发事件\n        this.trigger('play', { engine: this });\n        this._timerId = requestAnimationFrame((time) => {\n            this._prev = time;\n            this._tick({ now: time, autoEnd, to: toTime });\n        });\n        return true;\n    }\n    /**\n     * 暂停播放\n     * @memberof TimelineEngine\n     */\n    pause() {\n        if (this.isPlaying) {\n            this._playState = PAUSED;\n            // activeIds 运行 stop\n            this._startOrStop('stop');\n            this.trigger('paused', { engine: this });\n        }\n        this._timerId && cancelAnimationFrame(this._timerId);\n    }\n    /** 播放完成 */\n    _end() {\n        this.pause();\n        this.trigger('ended', { engine: this });\n    }\n    _startOrStop(type) {\n        var _a, _b;\n        for (let i = 0; i < this._activeActionIds.length; i++) {\n            const actionId = this._activeActionIds[i];\n            const action = this._actionMap[actionId];\n            const effect = this._effectMap[action === null || action === void 0 ? void 0 : action.effectId];\n            if (type === 'start') {\n                ((_a = effect === null || effect === void 0 ? void 0 : effect.source) === null || _a === void 0 ? void 0 : _a.start) && effect.source.start({ action, effect, engine: this, isPlaying: this.isPlaying, time: this.getTime() });\n            }\n            else if (type === 'stop') {\n                ((_b = effect === null || effect === void 0 ? void 0 : effect.source) === null || _b === void 0 ? void 0 : _b.stop) && effect.source.stop({ action, effect, engine: this, isPlaying: this.isPlaying, time: this.getTime() });\n            }\n        }\n    }\n    /** 每帧执行 */\n    _tick(data) {\n        if (this.isPaused)\n            return;\n        const { now, autoEnd, to } = data;\n        // 计算当前时间\n        let currentTime = this.getTime() + (Math.min(1000, now - this._prev) / 1000) * this._playRate;\n        this._prev = now;\n        // 设置当前时间\n        if (to && to <= currentTime)\n            currentTime = to;\n        this.setTime(currentTime, true);\n        // 执行动作\n        this._tickAction(currentTime);\n        // 自动停止情况下，判断是否所有动作执行完毕\n        if (!to && autoEnd && this._next >= this._actionSortIds.length && this._activeActionIds.length === 0) {\n            this._end();\n            return;\n        }\n        // 判断是否终止\n        if (to && to <= currentTime) {\n            this._end();\n        }\n        if (this.isPaused)\n            return;\n        this._timerId = requestAnimationFrame((time) => {\n            this._tick({ now: time, autoEnd, to });\n        });\n    }\n    /** tick运行actions */\n    _tickAction(time) {\n        var _a;\n        this._dealEnter(time);\n        this._dealLeave(time);\n        // render\n        const length = this._activeActionIds.length;\n        for (let i = 0; i < length; i++) {\n            const actionId = this._activeActionIds[i];\n            const action = this._actionMap[actionId];\n            const effect = this._effectMap[action.effectId];\n            if (effect && ((_a = effect.source) === null || _a === void 0 ? void 0 : _a.update)) {\n                effect.source.update({ time, action, isPlaying: this.isPlaying, effect, engine: this });\n            }\n        }\n    }\n    /** 重置active数据 */\n    _dealClear() {\n        var _a;\n        while (this._activeActionIds.length) {\n            const actionId = this._activeActionIds.shift();\n            const action = this._actionMap[actionId];\n            const effect = this._effectMap[action === null || action === void 0 ? void 0 : action.effectId];\n            if ((_a = effect === null || effect === void 0 ? void 0 : effect.source) === null || _a === void 0 ? void 0 : _a.leave) {\n                effect.source.leave({ action, effect, engine: this, isPlaying: this.isPlaying, time: this.getTime() });\n            }\n        }\n        this._next = 0;\n    }\n    /** 处理action time enter */\n    _dealEnter(time) {\n        var _a;\n        // add to active\n        while (this._actionSortIds[this._next]) {\n            const actionId = this._actionSortIds[this._next];\n            const action = this._actionMap[actionId];\n            if (!action.disable) {\n                // 判断动作开始时间是否到达\n                if (action.start > time)\n                    break;\n                // 动作可以执行开始\n                if (action.end > time && !this._activeActionIds.includes(actionId)) {\n                    const effect = this._effectMap[action.effectId];\n                    if (effect && ((_a = effect.source) === null || _a === void 0 ? void 0 : _a.enter)) {\n                        effect.source.enter({ action, effect, isPlaying: this.isPlaying, time, engine: this });\n                    }\n                    this._activeActionIds.push(actionId);\n                }\n            }\n            this._next++;\n        }\n    }\n    /** 处理action time leave */\n    _dealLeave(time) {\n        var _a;\n        let i = 0;\n        while (this._activeActionIds[i]) {\n            const actionId = this._activeActionIds[i];\n            const action = this._actionMap[actionId];\n            // 不在播放区域内\n            if (action.start > time || action.end < time) {\n                const effect = this._effectMap[action.effectId];\n                if (effect && ((_a = effect.source) === null || _a === void 0 ? void 0 : _a.leave)) {\n                    effect.source.leave({ action, effect, isPlaying: this.isPlaying, time, engine: this });\n                }\n                this._activeActionIds.splice(i, 1);\n                continue;\n            }\n            i++;\n        }\n    }\n    /** 处理数据 */\n    _dealData(data) {\n        const actions = [];\n        data.map((row) => {\n            actions.push(...row.actions);\n        });\n        const sortActions = actions.sort((a, b) => a.start - b.start);\n        const actionMap = {};\n        const actionSortIds = [];\n        sortActions.forEach((action) => {\n            actionSortIds.push(action.id);\n            actionMap[action.id] = { ...action };\n        });\n        this._actionMap = actionMap;\n        this._actionSortIds = actionSortIds;\n    }\n}\n"],"names":["Emitter","constructor","events","this","handlers","on","names","handler","Array","split","forEach","name","Error","push","trigger","params","String","reduce","r","e","bind","exist","isArray","off","listener","index","indexOf","splice","offAll","Object","fromEntries","keys","map","Events","beforeSetTime","afterSetTime","setTimeByTick","beforeSetPlayRate","afterSetPlayRate","setActiveActionIds","play","paused","ended","TimelineEngine","super","_playRate","_currentTime","_playState","_prev","_effectMap","_actionMap","_actionSortIds","_next","_activeActionIds","isPlaying","isPaused","effects","data","pause","_dealData","_dealClear","_dealEnter","setPlayRate","rate","engine","getPlayRate","reRender","_tickAction","setTime","time","isTick","_dealLeave","getTime","param","toTime","autoEnd","currentTime","_startOrStop","_timerId","requestAnimationFrame","_tick","now","to","cancelAnimationFrame","_end","type","_a","_b","i","length","actionId","action","effect","effectId","source","start","stop","Math","min","update","shift","leave","disable","end","includes","enter","actions","row","sortActions","sort","a","b","actionMap","actionSortIds","id"],"mappings":"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"}