(function(){"use strict";const d=self;d.onmessage=i=>{const{mask:t,width:o,height:f,spread:r}=i.data,e=Y(t,o,f,r);d.postMessage({sdf:e},[e.buffer])};function Y(i,t,o,f){const r=p(i,t,o,1),e=p(i,t,o,0),c=new Float32Array(t*o);for(let s=0;s<t*o;s++){const M=r[s],n=e[s];i[s]===0?c[s]=Math.min(f,M)/f:c[s]=-Math.min(f,n)/f}return c}function p(i,t,o,f){const r=t*o,e=new Int32Array(r).fill(-1),c=new Int32Array(r).fill(-1);for(let n=0;n<r;n++)i[n]===f&&(e[n]=n%t,c[n]=Math.floor(n/t));let s=Math.max(t,o);for(;s>=1;){s=Math.floor(s/2);for(let n=0;n<o;n++)for(let l=0;l<t;l++){const a=n*t+l;for(let u=-1;u<=1;u++)for(let x=-1;x<=1;x++){if(x===0&&u===0)continue;const m=l+x*s,A=n+u*s;if(m>=0&&m<t&&A>=0&&A<o){const D=A*t+m,y=e[D],S=c[D];if(y!==-1){const q=(l-y)**2+(n-S)**2,X=e[a],F=c[a];if(X===-1)e[a]=y,c[a]=S;else{const I=(l-X)**2+(n-F)**2;q<I&&(e[a]=y,c[a]=S)}}}}}if(s===1)break}const M=new Float32Array(r);for(let n=0;n<r;n++){const l=n%t,a=Math.floor(n/t),u=e[n],x=c[n];u===-1?M[n]=Math.max(t,o):M[n]=Math.sqrt((l-u)**2+(a-x)**2)}return M}})();
